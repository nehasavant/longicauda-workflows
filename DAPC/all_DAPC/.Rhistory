#load data from Wickecheoke stream salamanders
setwd("~/RADseq/DAPC_wick")
#set working directory session- set directory to Suburban sals- statistics DAPC
w1<-read.genepop("batch_1.gen")
w1clust<- find.clusters(w1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
#Run first dapc on b1clust
dapc.w1<- dapc (w1, w1clust$grp)
dapc.w1 <- dapc(w1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
dapc.w1$eig
#Figure out eigenvalue percent of variability in each discrimnant function
eig_percent <- round((dapc.w1$eig/(sum(dapc.w1$eig)))*100,2)
eig_percent
scatter(dapc.w1, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.w1, n.pca=1:ncol(dapc.w1$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=4) #calculating optimal number of PCs
#rerun DAPC with optimum PCs=5
dapc.w2 <- dapc(w2, var.contrib= TRUE, scale = FALSE, n.pca = 5, n.da = 5) #change PCs to the optimal
#rerun DAPC with optimum PCs=5
dapc.w2 <- dapc(w1, var.contrib= TRUE, scale = FALSE, n.pca = 5, n.da = 5) #change PCs to the optimal
dapc.w2.scatter<- scatter(dapc.w2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
#sum stats of a scores for your DAPC
summary(dapc(w2, n.da=5, n.pca=7))$assign.per.pop #summary stats for your PC presenting a-scores
#sum stats of a scores for your DAPC
summary(dapc(w1, n.da=5, n.pca=7))$assign.per.pop #summary stats for your PC presenting a-scores
#proportion of variable explained by PC
eig_percent <- round((dapc.w2$eig/(sum(dapc.w2$eig)))*100,2)
# what are the percent variance explained by PC1 and PC2?
eig_percent[1:7]
wick=list("UPPER", "MID A", "MID B", "LOWER")
#axes 1&2
scatter(dapc.w2, xax=1, yax=2, pch = 18:25, cstar = 0, txt.leg = wick, label = wick, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#axes 2&3
scatter(dapc.b3, xax=2, yax=3, pch = 18:25, cstar = 0, txt.leg = wick, label = wick, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#axes 2&3
scatter(dapc.w2, xax=2, yax=3, pch = 18:25, cstar = 0, txt.leg = wick, label = wick, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#set working directory session- set directory to Suburban sals- statistics DAPC
w1<-read.genepop("batch_1.gen")
w1clust<- find.clusters(w1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(w1), b1clust$grp)
table(pop(w1), w1clust$grp)
table.value(table(pop(w1), b1clust$grp), col.lab=paste("inf", 1:14), row.lab=paste("ori", 1:14))
#Run first dapc on b1clust
dapc.w1<- dapc (w1, w1clust$grp)
dapc.w1 <- dapc(w1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
#Running the DAPC
dapc.w1 <- dapc(w1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
#Figure out eigenvalue percent of variability in each discrimnant function
eig_percent <- round((dapc.w1$eig/(sum(dapc.w1$eig)))*100,2)
eig_percent
scatter(dapc.w1, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.w1, n.pca=1:ncol(dapc.w1$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=2) #calculating optimal number of PCs
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.w1, n.pca=1:ncol(dapc.w1$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=4) #calculating optimal number of PCs
#rerun DAPC with optimum PCs=5
dapc.w2 <- dapc(w1, var.contrib= TRUE, scale = FALSE, n.pca = 1, n.da = 4) #change PCs to the optimal
dapc.w2.scatter<- scatter(dapc.w2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
legend(dapc.b2scatter, position= "upperleft", ncol=2)
dapc.b2
#sum stats of a scores for your DAPC
summary(dapc(w1, n.da=5, n.pca=7))$assign.per.pop #summary stats for your PC presenting a-scores
#proportion of variable explained by PC
eig_percent <- round((dapc.w2$eig/(sum(dapc.w2$eig)))*100,2)
# what are the percent variance explained by PC1 and PC2?
eig_percent[1:7]
wick=list("UPPER", "MID A", "MID B", "LOWER")
#axes 1&2
scatter(dapc.w2, xax=1, yax=2, pch = 18:25, cstar = 0, txt.leg = wick, label = wick, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.w1, n.pca=1:ncol(dapc.w1$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=4) #calculating optimal number of PCs
#rerun DAPC with optimum PCs=5
dapc.w2 <- dapc(w1, var.contrib= TRUE, scale = FALSE, n.pca = 5, n.da = 4) #change PCs to the optimal
dapc.w2.scatter<- scatter(dapc.w2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
#rerun DAPC with optimum PCs=5
dapc.w2 <- dapc(w1, var.contrib= TRUE, scale = FALSE, n.pca = 4, n.da = 4) #change PCs to the optimal
dapc.w2.scatter<- scatter(dapc.w2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
#rerun DAPC with optimum PCs=5
dapc.w2 <- dapc(w1, var.contrib= TRUE, scale = FALSE, n.pca = 3, n.da = 4) #change PCs to the optimal
dapc.w2.scatter<- scatter(dapc.w2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
#rerun DAPC with optimum PCs=5
dapc.w2 <- dapc(w1, var.contrib= TRUE, scale = FALSE, n.pca = 2, n.da = 4) #change PCs to the optimal
dapc.w2.scatter<- scatter(dapc.w2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
#rerun DAPC with optimum PCs=5
dapc.w2 <- dapc(w1, var.contrib= TRUE, scale = FALSE, n.pca = 1, n.da = 4) #change PCs to the optimal
dapc.w2.scatter<- scatter(dapc.w2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
#rerun DAPC with optimum PCs=5
dapc.w2 <- dapc(w1, var.contrib= TRUE, scale = FALSE, n.pca = 6, n.da = 4) #change PCs to the optimal
dapc.w2.scatter<- scatter(dapc.w2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
#rerun DAPC with optimum PCs=5
dapc.w2 <- dapc(w1, var.contrib= TRUE, scale = FALSE, n.pca = 5, n.da = 4) #change PCs to the optimal
dapc.w2.scatter<- scatter(dapc.w2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
#axes 1&2
scatter(dapc.w2, xax=1, yax=2, pch = 18:25, cstar = 0, txt.leg = wick, label = wick, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#load data from Wickecheoke stream salamanders
setwd("~/RADseq/DAPC_all")
#set working directory session- set direÃŸctory to Suburban sals- statistics DAPC
a1<-read.genepop("batch_1.gen")
a1
str(a1)
pop(a1)
a1clust<- find.clusters(a1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
popname1=list("CAPO-s", "COOK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "MUCK2-p", "MUCK1-p", "MUCK3-p", "WICK-s", "SVEN-p", "SWAR-p", "WARF-s", "WHIT-s", "WPOA-p")
table(pop(a1), a1clust$grp)
table.value(table(pop(a1), a1clust$grp), col.lab=paste("cluster", 1:3), row.lab=paste(popname1))
#Run first dapc on b1clust
dapc.a1<- dapc (a1, a1clust$grp)
dapc.a1 <- dapc(a1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
#retain 2 DA since there are only 2 displayed
dapc.a1$eig
#Figure out eigenvalue percent of variability in each discrimnant function
eig_percent <- round((dapc.a1$eig/(sum(dapc.a1$eig)))*100,2)
eig_percent #90.12  9.88
scatter(dapc.a1, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.a1, n.pca=1:ncol(dapc.b1$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=2) #calculating optimal number of PCs
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.a1, n.pca=1:ncol(dapc.a1$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=2) #calculating optimal number of PCs
#rerun DAPC with optimum PCs=7
dapc.a2 <- dapc(a1, var.contrib = TRUE, scale = FALSE, n.pca = 7, n.da = 2) #change PCs to the optimal
scatter(dapc.a2, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
dapc.a2scatter<- scatter(dapc.a2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
legend(dapc.a2scatter, position= "upperleft", ncol=2)
dapc.a2
#Loading plot
loadingplot(dapc.a2$var.contr, axis=2, thres=0.07, lab.jitter=1) #there are no alleles that contribute disproporitonately to the DAPC.
#compoplot (STRUCTURE-like plot). Not sure how to use this properly.
compoplot(dapc.a2, posi="bottomright", txt.leg=paste("Cluster", 1:14), lab="", ncol=1, xlab="inidividuals")
#Second compoplot
popname1=list("CAPO-s", "COOK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "MUCK2-p", "MUCK1-p", "MUCK3-p", "WICK-s", "SVEN-p", "SWAR-p", "WARF-s", "WHIT-s", "WPOA-p")
streams=list("CAPO-s", "COOK-s", "WICK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "WARF-s")
compoplot(dapc.a2, cleg=0.4, posi=list(x=0, y=-0), lab=popname1, only.grp=streams)
#sum stats of a scores for your DAPC
summary(dapc(a1, n.da=5, n.pca=7))$assign.per.pop #summary stats for your PC presenting a-scores
#proportion of variable explained by PC
eig_percent <- round((dapc.a2$eig/(sum(dapc.b2$eig)))*100,2)
#proportion of variable explained by PC
eig_percent <- round((dapc.a2$eig/(sum(dapc.a2$eig)))*100,2)
# what are the percent variance explained by PC1 and PC2?
eig_percent[1:7]
#axes 1&2
popname1=list("CAPO-s", "COOK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "MUCK2-p", "MUCK1-p", "MUCK3-p", "WICK-s", "SVEN-p", "SWAR-p", "WARF-s", "WHIT-s", "WPOA-p")
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname, label=popname, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex=2, s.label(c.sub=1.25))
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname, label=popname, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex=2)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex=2)
a1clust<- find.clusters(a1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
#Run first dapc on b1clust
dapc.a1<- dapc (a1, a1clust$grp)
?dapc
?dapc()
#Running the DAPC
dapc.a1 <- dapc(a1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
#retain 10 DA
dapc.a1$eig
#Figure out eigenvalue percent of variability in each discrimnant function
eig_percent <- round((dapc.a1$eig/(sum(dapc.a1$eig)))*100,2)
eig_percent #90.12  9.88
scatter(dapc.a1, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.a1, n.pca=1:ncol(dapc.a1$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=10) #calculating optimal number of PCs
#rerun DAPC with optimum PCs=7
dapc.a2 <- dapc(a1, var.contrib = TRUE, scale = FALSE, n.pca = 7, n.da = 10) #change PCs to the optimal
scatter(dapc.a2, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
dapc.a2scatter<- scatter(dapc.a2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
legend(dapc.a2scatter, position= "upperleft", ncol=2)
dapc.a2
#Second compoplot
popname1=list("CAPO-s", "COOK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "MUCK2-p", "MUCK1-p", "MUCK3-p", "WICK-s", "SVEN-p", "SWAR-p", "WARF-s", "WHIT-s", "WPOA-p")
#axes 1&2
popname1=list("CAPO-s", "COOK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "MUCK2-p", "MUCK1-p", "MUCK3-p", "WICK-s", "SVEN-p", "SWAR-p", "WARF-s", "WHIT-s", "WPOA-p")
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex=2)
#axes 2&3
scatter(dapc.a2, xax=2, yax=3, pch = 18:25, txt.leg = popname, label=popname, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomright", clabel=0.6, cellipse=TRUE, posi.leg="topleft")
#axes 2&3
scatter(dapc.a2, xax=2, yax=3, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomright", clabel=0.6, cellipse=TRUE, posi.leg="topleft")
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex=6)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=1, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex=2)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=1, cellipse=TRUE, posi.leg="topleft", cex=2)
?scatter
a1
a1
pop(a1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex=2)
title("DAPC with All Individuals") #Set Title
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex=1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex=1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex=1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex=1, cex.lab=2)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex=1, cex.lab=4)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex.lab=4)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex =1, cex.lab=4)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 0.4, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 1, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 0.9, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 1.5, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 1.5, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.6, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 1.5, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 1.5, cleg=0.68, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 1.5, cleg=0.65, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
#axes 2&3
scatter(dapc.a2, xax=2, yax=3, pch = 18:25, txt.leg = popname1, label=popname1, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomright", clabel=0.6, cellipse=TRUE, posi.leg="topleft")
#axes 2&3
scatter(dapc.a2, xax=2, yax=3, pch = 18:25, txt.leg = popname1, label=popname1, cleg=0.75, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomright", clabel=0.6, cellipse=TRUE, posi.leg="topleft")
#load data from Wickecheoke stream salamanders
setwd("~/Dropbox/Columbia_New_York/Salamanders/Downstream_Analyses/all_DAPC/")
#set working directory session- set direÃŸctory to Suburban sals- statistics DAPC
c1<-read.genepop("batch_1_noSWAR.gen")
c1clust<- find.clusters(b4, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
c1clust<- find.clusters(c1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
c1clust<- find.clusters(c1, max.n.clust=40, n.pca=NULL)
c2clust<- find.clusters(c1, max.n.clust=40, n.pca=NULL)
table(pop(c1), c2clust$grp)
c2clust<- find.clusters(c1, max.n.clust=40, n.pca=NULL)
table(pop(c1), c2clust$grp)
#Run first dapc on b1clust
dapc.c1<- dapc (c1, c2clust$grp)
scatter(dapc.c1,cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2)
popname1=list("CAPO-s", "COOK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "MUCK2-p", "MUCK1-p", "MUCK3-p", "WICK-s", "SVEN-p", "SWAR-p", "WARF-s", "WHIT-s", "WPOA-p")
scatter(dapc.c1,cell = 0, pch = 18:23, cstar = 0, label = popname1, mstree = FALSE, lwd = 2, lty = 2)
#Running the DAPC
dapc.c1 <- dapc(c1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
scatter(dapc.c1, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
#load data from Wickecheoke stream salamanders
setwd("~/Dropbox/Columbia_New_York/Salamanders/Downstream_Analyses/all_DAPC/")
#set working directory session- set direÃŸctory to Suburban sals- statistics DAPC
c1<-read.genepop("batch_1_noSWAR.gen")
c1clust<- find.clusters(c1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
c2clust<- find.clusters(c1, max.n.clust=40, n.pca=NULL)
table(pop(c1), c2clust$grp)
#Run first dapc on b1clust
dapc.c1<- dapc (c1, c2clust$grp)
#Run first dapc on b1clust
dapc.c1<- dapc (c1, c2clust$grp)
scatter(dapc.c1,cell = 0, pch = 18:23, cstar = 0, label = popname1, mstree = FALSE, lwd = 2, lty = 2)
#Running the DAPC
dapc.c1 <- dapc(c1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
#retain 10 DA
dapc.c1$eig
#Figure out eigenvalue percent of variability in each discrimnant function
eig_percent <- round((dapc.c1$eig/(sum(dapc.c1$eig)))*100,2)
eig_percent #90.12  9.88
scatter(dapc.c1, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.c1, n.pca=1:ncol(dapc.c1$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=10) #calculating optimal number of PCs
#rerun DAPC with optimum PCs=7
dapc.c2 <- dapc(c1, var.contrib = TRUE, scale = FALSE, n.pca = 7, n.da = 10) #change PCs to the optimal
scatter(dapc.c2, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
dapc.c1.scatter<- scatter(dapc.c2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="bottomright", ncol=2)
#Second compoplot
popname1=list("CAPO-s", "COOK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "MUCK2-p", "MUCK1-p", "MUCK3-p", "WICK-s", "SVEN-p", "WARF-s", "WHIT-s", "WPOA-p")
#axes 1&2
popname_noSWAR=list("CAPO-s", "COOK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "MUCK2-p", "MUCK1-p", "MUCK3-p", "WICK-s", "SVEN-p", "WARF-s", "WHIT-s", "WPOA-p")
scatter(dapc.c2, xax=1, yax=2, pch = 18:25, txt.leg = popname_noSWAR, label=popname_noSWAR, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="bottomright", cex=2)
scatter(dapc.c2, xax=1, yax=2, pch = 18:25, txt.leg = popname_noSWAR, label=popname_noSWAR, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="bottomright", cex=2)
#axes 2&3
scatter(dapc.c2, xax=2, yax=3, pch = 18:25, txt.leg = popname_noSWAR, label=popname, cstar=0, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomright", clabel=0.6, cellipse=TRUE, posi.leg="topleft")
#axes 1&2
popname_noSWAR=list("CAPO-s", "COOK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "MUCK2-p", "MUCK1-p", "MUCK3-p", "WICK-s", "SVEN-p", "WARF-s", "WHIT-s", "WPOA-p")
#axes 2&3
scatter(dapc.c2, xax=2, yax=3, pch = 18:25, txt.leg = popname_noSWAR, label=popname, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomright", clabel=0.6, cellipse=TRUE, posi.leg="topleft")
#axes 2&3
scatter(dapc.c2, xax=2, yax=3, pch = 18:25, txt.leg = popname_noSWAR, label=popname_noSWAR, cleg=0.7, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.179, posi.da = "bottomright", clabel=0.6, cellipse=TRUE, posi.leg="topleft")
#load data from Wickecheoke stream salamanders
setwd("~/Dropbox/Columbia_New_York/Salamanders/Downstream_Analyses/piedmont_DAPC")
#set working directory session- set directory to Suburban sals- statistics DAPC
p1<-read.genepop("batch_1_Piedmont.gen")
pop(p1) #For some reason it is reading the popuations wrong. OLD009, UPP022, UPP021 and WICK015 are the populations names. These are the names of the final samples in each pop...
p1clust<- find.clusters(p1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(p1), p1clust$grp)
p1clust<- find.clusters(p1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(p1), p1clust$grp)
#Running the DAPC
dapc.p2 <- dapc(p1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
dapc.p2$eig
#Figure out eigenvalue percent of variability in each discrimnant function
eig_percent <- round((dapc.p2$eig/(sum(dapc.p2$eig)))*100,2)
eig_percent
scatter(dapc.p2, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.p2, n.pca=1:ncol(dapc.p2$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=6) #calculating optimal number of PCs
#rerun DAPC with optimum PCs=7
dapc.p3 <- dapc(p2, var.contrib= TRUE, scale = FALSE, n.pca = 7, n.da = 6) #change PCs to the optimal
#rerun DAPC with optimum PCs=7
dapc.p3 <- dapc(p1, var.contrib= TRUE, scale = FALSE, n.pca = 7, n.da = 6) #change PCs to the optimal
dapc.p3.scatter<- scatter(dapc.p3, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
#sum stats of a scores for your DAPC
summary(dapc(p1, n.da=6, n.pca=7))$assign.per.pop #summary stats for your PC presenting a-scores
#proportion of variable explained by PC
eig_percent <- round((dapc.p3$eig/(sum(dapc.p3$eig)))*100,2)
# what are the percent variance explained by PC1 and PC2?
eig_percent[1:7]
piedmont=list("CAPO", "COOK", "HAKI", "HARI", "LNIS", "LOCK", "WICK", "WARF")
#axes 1&2
scatter(dapc.p3, xax=1, yax=2, pch = 18:25, cstar = 0, txt.leg = piedmont, label = piedmont, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#axes 1&2
scatter(dapc.p3, xax=1, yax=2, pch = 18:25, txt.leg = piedmont, label = piedmont, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#axes 2&3
scatter(dapc.p3, xax=2, yax=3, pch = 18:25, txt.leg = piedmont, label = piedmont, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#axes 2&3
scatter(dapc.p3, xax=2, yax=3, pch = 18:25, txt.leg = piedmont, label = piedmont, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft")
#load data from Wickecheoke stream salamanders
setwd("~/Dropbox/Columbia_New_York/Salamanders/Downstream_Analyses/RidgeValley_DAPC")
#set working directory session- set directory to Suburban sals- statistics DAPC
r1<-read.genepop("batch_1_RidgeValley.gen")
#set working directory session- set directory to Suburban sals- statistics DAPC
r1<-read.genepop("batch_1_RidgeValley.gen")
r1clust<- find.clusters(r1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(r1), r1clust$grp)
#Running the DAPC
dapc.r2 <- dapc(r1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
#Running the DAPC
dapc.r2 <- dapc(r1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
dapc.r2$eig
#Figure out eigenvalue percent of variability in each discrimnant function
eig_percent <- round((dapc.r2$eig/(sum(dapc.r2$eig)))*100,2)
eig_percent
scatter(dapc.r2, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.r2, n.pca=1:ncol(dapc.r2$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=6) #calculating optimal number of PCs
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.r2, n.pca=1:ncol(dapc.r2$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=4) #calculating optimal number of PCs
#rerun DAPC with optimum PCs=6
dapc.r3 <- dapc(r1, var.contrib= TRUE, scale = FALSE, n.pca = 6, n.da = 4) #change PCs to the optimal
dapc.r3.scatter<- scatter(dapc.r3, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
ridge=list("MUCK2", "MUCK1", "MUCK3", "SVEN", "SWAR", "WHIT", "WPOA")
#axes 1&2
scatter(dapc.r3, xax=1, yax=2, pch = 18:25, txt.leg = ridge, label = ridge, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#axes 1&2
scatter(dapc.r3, xax=1, yax=2, pch = 18:25, txt.leg = ridge, label = ridge, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#axes 2&3
scatter(dapc.r3, xax=2, yax=3, pch = 18:25, txt.leg = piedmont, label = piedmont, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft")
#load data from Wickecheoke stream salamanders
setwd("~/Dropbox/Columbia_New_York/Salamanders/Downstream_Analyses/RidgeValley_DAPC")
#set working directory session- set directory to Suburban sals- statistics DAPC
n1<-read.genepop("batch_1_RidgeValley_noSWAR.gen")
n1clust<- find.clusters(n1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(n1), n1clust$grp)
n1clust<- find.clusters(n1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(n1), n1clust$grp)
n1clust<- find.clusters(n1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
#Running the DAPC
dapc.n2 <- dapc(n1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
dapc.n2$eig
#Figure out eigenvalue percent of variability in each discrimnant function
eig_percent <- round((dapc.r2$eig/(sum(dapc.n2$eig)))*100,2)
eig_percent
scatter(dapc.n2, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.n2, n.pca=1:ncol(dapc.r2$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=3) #calculating optimal number of PCs
#rerun DAPC with optimum PCs=6
dapc.n3 <- dapc(n1, var.contrib= TRUE, scale = FALSE, n.pca = 4, n.da = 3) #change PCs to the optimal
dapc.n3.scatter<- scatter(dapc.n3, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
legend(dapc.r2scatter, position= "upperleft", ncol=2)
dapc.r3
#sum stats of a scores for your DAPC
summary(dapc(n1, n.da=6, n.pca=7))$assign.per.pop #summary stats for your PC presenting a-scores
#proportion of variable explained by PC
eig_percent <- round((dapc.n3$eig/(sum(dapc.n3$eig)))*100,2)
# what are the percent variance explained by PC1 and PC2?
eig_percent[1:7]
ridge=list("MUCK2", "MUCK1", "MUCK3", "SVEN", "WHIT", "WPOA")
#axes 1&2
scatter(dapc.n3, xax=1, yax=2, pch = 18:25, txt.leg = ridge, label = ridge, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#axes 2&3
scatter(dapc.n3, xax=2, yax=3, pch = 18:25, txt.leg = ridge, label = piedmont, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft")
#axes 2&3
scatter(dapc.n3, xax=2, yax=3, pch = 18:25, txt.leg = ridge, label = ridge, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft")
#axes 2&3
scatter(dapc.r3, xax=2, yax=3, pch = 18:25, txt.leg = ridge, label = ridge, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft")
ridge=list("MUCK2", "MUCK1", "MUCK3", "SVEN", "SWAR", "WHIT", "WPOA")
#axes 1&2
scatter(dapc.r3, xax=1, yax=2, pch = 18:25, txt.leg = ridge, label = ridge, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#axes 2&3
scatter(dapc.r3, xax=2, yax=3, pch = 18:25, txt.leg = ridge, label = ridge, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft")
n1clust<- find.clusters(n1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(n1), n1clust$grp)
#Running the DAPC
dapc.n2 <- dapc(n1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.n2, n.pca=1:ncol(dapc.r2$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=3) #calculating optimal number of PCs
#rerun DAPC with optimum PCs=4
dapc.n3 <- dapc(n1, var.contrib= TRUE, scale = FALSE, n.pca = 4, n.da = 3) #change PCs to the optimal
ridge=list("MUCK2", "MUCK1", "MUCK3", "SVEN", "WHIT", "WPOA")
#axes 1&2
scatter(dapc.n3, xax=1, yax=2, pch = 18:25, txt.leg = ridge, label = ridge, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#axes 2&3
scatter(dapc.n3, xax=2, yax=3, pch = 18:25, txt.leg = ridge, label = ridge, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft")
tbl=read.table("batch_1_all.3.Q")
#set the working directory
setwd("~/Dropbox/Columbia_New_York/Salamanders/Downstream_Analyses/all_ADMIXTURE/")
x <- readQ("batch_1_all.3.Q")
names=list("CAPO", "COOK", "HAKI", "HARI", "LNIS", "LOCK", "MUCK2", "MUCK1", "MUCK3", "WICK", "SVEN", "SWAR", "WHIT", "WPOA")
plotQ(x, returnplot=T, titlelab="ADMIXTURE for all samples", titlesize=5, showlegend=TRUE, label = names, showindlab=TRUE, indlabsize=3)
?plotQ
plotQ(x, returnplot=T, titlelab="ADMIXTURE for all samples", titlesize=5, showlegend=TRUE, useindlab = TRUE, indlabsize=3)
plotQ(x, returnplot=T, titlelab="ADMIXTURE for all samples", titlesize=5, showlegend=TRUE, ordergrp=TRUE, grplab=data.frame(labs=c("CAPO", "COOK", "HAKI", "HARI", "LNIS", "LOCK", "MUCK2", "MUCK1", "MUCK3", "WICK", "SVEN", "SWAR", "WHIT", "WPOA"),stringsAsFactors=F))
names=dataframe(rownames="CAPO", "COOK", "HAKI", "HARI", "LNIS", "LOCK", "MUCK2", "MUCK1", "MUCK3", "WICK", "SVEN", "SWAR", "WHIT", "WPOA")
names=dataframe(row.names="CAPO", "COOK", "HAKI", "HARI", "LNIS", "LOCK", "MUCK2", "MUCK1", "MUCK3", "WICK", "SVEN", "SWAR", "WHIT", "WPOA")
plotQ(x, returnplot=T, titlelab="ADMIXTURE for all samples", titlesize=5, showlegend=TRUE, ordergrp=TRUE, grplab=data.frame(labs=c("CAPO", "COOK", "HAKI", "HARI", "LNIS", "LOCK", "MUCK2", "MUCK1", "MUCK3", "WICK", "SVEN", "SWAR", "WHIT", "WPOA")),stringsAsFactors=F)
plotQ(x, returnplot=T, titlelab="ADMIXTURE for all samples", titlesize=5, showlegend=TRUE, ordergrp=TRUE, grplab=data.frame(labs=c("CAPO", "COOK", "HAKI", "HARI", "LNIS", "LOCK", "MUCK2", "MUCK1", "MUCK3", "WICK", "SVEN", "SWAR", "WHIT", "WPOA"),stringsAsFactors=F))
View(names)
View(names)
#load data from Wickecheoke stream salamanders
setwd("~/Dropbox/Columbia_New_York/Salamanders/Downstream_Analyses/pond_complex_DAPC/")
#set working directory session- set directory to Suburban sals- statistics DAPC
x1<-read.genepop("batch_1_RidgeValley_noSWAR.gen")
#set working directory session- set directory to Suburban sals- statistics DAPC
x1<-read.genepop("batch_1_pondcomplex.gen")
pop(nx)
pop(x)
pop(x1)
n1clust<- find.clusters(x1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(x1), x1clust$grp)
table(pop(x1), x1clust$grp)
x1clust<- find.clusters(x1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(x1), x1clust$grp)
table.value(table(pop(x1), x1clust$grp), col.lab=paste("inf", 1:5), row.lab=paste("ori", 1:5))
#Run first dapc on b1clust
dapc.x1<- dapc (x1, x1clust$grp)
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.x2, n.pca=1:ncol(dapc.x2$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=3) #calculating optimal number of PCs
#Running the DAPC
dapc.x2 <- dapc(x1, var.contrib = TRUE, scale = FALSE, n.pca = 40, n.da = NULL) #run the DAPC
x1clust<- find.clusters(x1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(x1), x1clust$grp)
x1clust<- find.clusters(x1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(x1), x1clust$grp)
table.value(table(pop(x1), x1clust$grp), col.lab=paste("inf", 1:5), row.lab=paste("ori", 1:5))
#Run first dapc on b1clust
dapc.x1<- dapc (x1, x1clust$grp)
#Running the DAPC
dapc.x2 <- dapc(x1, var.contrib = TRUE, scale = FALSE, n.pca = 60, n.da = NULL) #run the DAPC
dapc.x2$eig
#Figure out eigenvalue percent of variability in each discrimnant function
eig_percent <- round((dapc.x2$eig/(sum(dapc.x2$eig)))*100,2)
eig_percent
scatter(dapc.x2, cell = 0, pch = 18:23, cstar = 0, mstree = FALSE, lwd = 2, lty = 2) #run the scatter of the DAPC
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.x2, n.pca=1:ncol(dapc.x2$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=1) #calculating optimal number of PCs
#calculating the optimum PC number to rerun DAPC
optim.a.score(dapc.x2, n.pca=1:ncol(dapc.x2$tab), smart=TRUE, n=10, plot=TRUE, n.sim=10, n.da=3) #calculating optimal number of PCs
#rerun DAPC with optimum PCs=7
dapc.x3 <- dapc(x1, var.contrib= TRUE, scale = FALSE, n.pca = 7, n.da = 3) #change PCs to the optimal
dapc.x3.scatter<- scatter(dapc.x3, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
legend(dapc.x2scatter, position= "upperleft", ncol=2)
complex=list("MUCK2", "MUCK1", "MUCK3", "WHIT", "WPOA")
#axes 1&2
scatter(dapc.x3, xax=1, yax=2, pch = 18:25, txt.leg = complex, label = complex, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topright")
#axes 2&3
scatter(dapc.x3, xax=2, yax=3, pch = 18:25,  txt.leg = complex, label = complex, mstree = FALSE, scree.da=TRUE, posi.da = "bottomright", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft")
#load data from Wickecheoke stream salamanders
setwd("~/Dropbox/Columbia_New_York/Salamanders/Downstream_Analyses/DAPC_all")
#load data from Wickecheoke stream salamanders
setwd("~/Dropbox/Columbia_New_York/Salamanders/Downstream_Analyses/DAPC_all")
#load data from all salamanders
setwd("~/Dropbox/Columbia_New_York/Salamanders/Downstream_Analyses/all_DAPC")
#set working directory session- set direÃŸctory to Suburban sals- statistics DAPC
a1<-read.genepop("batch_1.gen")
a1clust<- find.clusters(a1, max.n.clust=40, n.pca=NULL) #finding clusters, first set to max PCs and retain lowest point of BIC
table(pop(a1), a1clust$grp)
setwd("~/Dropbox/Columbia_New_York/Salamanders/Downstream_Analyses/all_DAPC")
library(genepop)
library("genepop")
install.packages("genepop")
library("genepop")
all <- genepop
all <- read.genepop(batch_1.gen)
all <- read.genepop("batch_1.gen")
#rerun DAPC with optimum PCs=7
dapc.a2 <- dapc(all, var.contrib = TRUE, scale = FALSE, n.pca = 7, n.da = 10) #change PCs to the optimal
#Second compoplot
popname1=list("CAPO-s", "COOK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "MUCK2-p", "MUCK1-p", "MUCK3-p", "WICK-s", "SVEN-p", "SWAR-p", "WARF-s", "WHIT-s", "WPOA-p")
#axes 1&2
popname1=list("CAPO-s", "COOK-s", "HAKI-s", "HARI-s", "LNIS-s", "LOCK-s", "MUCK2-p", "MUCK1-p", "MUCK3-p", "WICK-s", "SVEN-p", "SWAR-p", "WARF-s", "WHIT-s", "WPOA-p")
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 1.5, cleg=0.65, legend=TRUE, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 1.5, cleg=0.65, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 1.7, cleg=0.65, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 1.7, cleg=0.65, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 2, cleg=0.65, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, cex.lab = 2, cleg=0.7, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
library(RColorBrewer)
dapc.a2scatter<- scatter(dapc.a2, pch = 18:25, cstar = 0, mstree = FALSE, scree.da=TRUE, posi.da = "bottomleft", ratio.da= 0.179, cex=1.0, cex.lab=0.5, cex.main=0.5, cellipse=TRUE, legend=TRUE, posi.leg="topleft", ncol=2)
#rerun DAPC with optimum PCs=7
dapc.a2 <- dapc(all, var.contrib = TRUE, scale = FALSE, n.pca = 7, n.da = 10) #change PCs to the optimal
display.brewer.all()
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, col = spectral, cex.lab = 2, cleg=0.7, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
spec <- brewer.pal("Spectral)
spec <- brewer.pal("Spectral")
spec <- brewer.pal("Spectral")
spec <- brewer.pal(14, "Spectral")
spec <- brewer.pal(11, "Spectral")
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, col = spec, cex.lab = 2, cleg=0.7, mstree = FALSE, scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, col = spec, cex.lab = 2, cleg=0.7, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  col = ryg, cex.lab = 2, cleg=0.7, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, col = ryg, cex.lab = 2, cleg=0.7, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
ryg <- brewer.pal(11, "RdYlGn") #col = spec,
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1, col = ryg, cex.lab = 2, cleg=0.7, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, cleg=0.7, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, cleg=0.7, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.5, cellipse=TRUE, posi.leg="topleft", cex =1)
7
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, cleg=0.7, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.7, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, cleg=0.7, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.8, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  clab = 2, cleg=0.7, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.8, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, cleg=0.7, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.19, posi.da = "bottomleft", clabel=0.8, cellipse=TRUE, posi.leg="topleft", cex =1)
7
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, cleg=0.7, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.9, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, cleg=0.9, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.9, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, cleg=0.5, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.9, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, cleg=0.6, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.9, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, cleg=0.6, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.9, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, cleg=0.6, mstree = FALSE, legend = TRUE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.85, cellipse=TRUE, posi.leg="topleft", cex =1)
scatter(dapc.a2, xax=1, yax=2, pch = 18:25, txt.leg = popname1, label=popname1,  cex.lab = 2, mstree = FALSE,  scree.da=TRUE, ratio.da= 0.17, posi.da = "bottomleft", clabel=0.85, cellipse=TRUE, posi.leg="topleft", cex =1)
